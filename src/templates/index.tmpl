{{ template "generic_page" .}}

{{ define "title" }}
    {{ if .UserIsLoggedIn }}
        Your Notes
    {{ else }}
        Notes
    {{ end }}
{{ end }}

{{ define "header" }}
    {{ template "title" . }}
{{ end }}

{{ define "contents" }}
    {{ if .UserIsLoggedIn }}
        {{ if .Notes }}
            {{ range .Notes }}
                <a href="/notes/{{ .ID }}">{{ .Name }}</a>
            {{ end }}
        {{ else }}
            <p>You haven't created any notes yet!</p>
        {{ end }}
    {{ else }}
        <p>It seems like you're not logged in!</p>
        <script src="https://apis.google.com/js/platform.js" async defer></script>
        <meta name="google-signin-client_id" content="852436479284-6t9jptc5el744ti4o59a98ufh6uilnim.apps.googleusercontent.com">
        <div class="g-signin2" data-onsuccess="onSignIn"></div>
        <script>
            async function onSignIn(googleUser) {
                const idToken = googleUser.getAuthResponse().id_token;
                let requestForm = new FormData();
                requestForm.set("id_token", idToken);
                await fetch("/api/login/", {
                    method: "POST",
                    body: requestForm,
                });
                location.reload();
            }
        </script>
    {{ end }}
{{ end }}
